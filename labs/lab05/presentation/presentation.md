---
## Front matter
lang: ru-RU
title: Лабораторная работа №5
subtitle: "Модель эпидемии (SIR)"
author:
  - Кадров Виктор Максимович
teacher:
  - Кулябов Д. С.
  - д.ф.-м.н., профессор
  - профессор кафедры теории вероятностей и кибербезопасности 
institute:
  - Российский университет дружбы народов имени Патриса Лумумбы, Москва, Россия
date: 12 апреля 2025

## i18n babel
babel-lang: russian
babel-otherlangs: english

## Formatting pdf
toc: false
toc-title: Содержание
slide_level: 2
aspectratio: 169
section-titles: true
theme: metropolis
header-includes:
 - \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
---

## Цель работы

Исслеодвать модель эпидемии(SIR) с помощью программы *xcos* и OpenModelica.

## Задание

- рассмотреть модель SIR в xcos (в том числе и с использованием блока Modelica), а также в OpenModelica;
- реализовать модель SIR с учётом процесса рождения / гибели особей в xcos (в том числе и с использованием блока Modelica), а также в OpenModelica;
- построить графики эпидемического порога при различных значениях параметров модели (в частности изменяя параметр µ);
- сделать анализ полученных графиков в зависимости от выбранных значений параметров модели.

## Математическая модель

$$
\begin{cases}
	\frac{dS}{dt} = - \frac{\beta I S}{N}, \\
	\frac{dI}{dt} = \frac{\beta I S}{N} - \gamma I, \\
	\frac{dR}{dt} = \gamma I,
\end{cases}
$$

где $S$ -- численность восприимчивой популяции, $I$ -- численность инфицированных, $R$ -- численность удаленной популяции (в результате смерти или выздоровления), и $N$ -- это сумма этих трёх, а $\beta$ и $\gamma$ - это коэффициенты заболеваемости и выздоровления соответственно[@l].

## Реализация модели в xcos

В меню Моделирование, Задать переменные окружения зададим значения переменных.

![Ввод переменных окружения](image/1.png){#fig:001 width=50%}

## Реализация модели в xcos

![Модель SIR в xcos](image/2.png){#fig:002 width=60%}

## Реализация модели в xcos

![Задать начальные значение в блоке интегрирования для S](image/3.png){#fig:003 width=60%}

## Реализация модели в xcos

![Задать начальные значение в блоке интегрирования для I](image/4.png){#fig:004 width=60%}

## Реализация модели в xcos

Зададим конечное время интегрирования.

![Зададим конечное время интегрирования](image/5.png){#fig:005 width=70%}

## Реализация модели в xcos

Результат моделирования в xcos. 

![Результат моделирования в xcos](image/6.png){#fig:006 width=50%} 

## Реализация модели с помощью блока Modelica в xcos

Для реализации модели с помощью языка Modelica помимо блоков CLOCK_c, CSCOPE, TEXT_f и MUX требуются блоки CONST_m -- задаёт константу; MBLOCK(Modelica generic) -- блок реализации кода на языке Modelica.

![Модель SIR в xcos с применением блока Modelica](image/7.png){#fig:007 width=40%} 

## Реализация модели с помощью блока Modelica в xcos

![Параметры блока Modelica](image/8.png){#fig:008 width=50%}

## Реализация модели с помощью блока Modelica в xcos

![Параметры блока Modelica](image/10.png){#fig:009 width=50%} 

## Реализация модели с помощью блока Modelica в xcos

![Результат моделирования с помощью блока Modelica в xcos](image/9.png){#fig:010 width=70%} 


## Реализация модели SIR в OpenModelica

Создадим файл модели, зададим дифференциальные уравнения и присвоим переменным значения. 

![Реализация модели SIR в OpenModelica](image/11.png){#fig:011 width=50%} 

## Реализация модели SIR в OpenModelica

Зададим интервал симуляции. 

![Зададим интервал симуляции](image/12.png){#fig:012 width=50%}

## Реализация модели SIR в OpenModelica

Результат реализации модели SIR в OpenModelica.

![Результат реализации модели SIR в OpenModelica](image/13.png){#fig:013 width=50%} 

## Модель SIR с учетом демографии

В дополнение к предположениям, которые были сделаны для модели SIR, предположим, что учитываются демографические процессы, в частности, что смертность в популяции полностью уравновешивает рождаемость, а все рожденные индивидуумы появляются на свет абсолютно здоровыми. Тогда получим следующую систему уравнений:

$$
\begin{cases}
\frac{dS}{dt} = - \beta I S + \mu (N - S), \\
\frac{dI}{dt} = \beta I S - \gamma I - \mu I, \\
\frac{dR}{dt} = \gamma I - \mu R,
\end{cases}
$$


## Реализация модели в xcos

![Модель SIR, учитывая демографические процессы, в xcos](image/14.png){#fig:014 width=40%}

## Реализация модели в xcos

![Результат моделирования SIR, учитывая демографические процессы, в xcos](image/15.png){#fig:015 width=50%}

## Реализация модели с использованием блока Modelica в xcos

В изначальную реализацию с помощью блока Modelica добавим параметр $\mu$.

![Модель SIR с учетом демографии в xcos с применением блока Modelica](image/15_1.png){#fig:016 width=70%}

## Реализация модели с использованием блока Modelica в xcos

![Параметры блока Modelica. Модель SIR с учетом демографии](image/16.png){#fig:017 width=50%} 

## Реализация модели с использованием блока Modelica в xcos

![Код на языке Modelica. Модель SIR с учетом демографии](image/17.png){#fig:018 width=50%} 

## Реализация модели с использованием блока Modelica в xcos

![Результат моделирования SIR с учетом демографии с помощью блока Modelica в xcos](image/18.png){#fig:019 width=70%} 

## Реализация модели SIR с учетом демографии в OpenModelica

![Реализация модели SIR с учетом демографии в OpenModelica](image/19.png){#fig:020 width=50%} 

## Реализация модели SIR с учетом демографии в OpenModelica

![Результат реализации модели SIR с учетом демографии в OpenModelica](image/20.png){#fig:021 width=50%} 

## Анализ графиков при разных параметрах модели

Когда параметр $\mu$ достигает значения 0.8 на графике появляются прямые. То есть рождается и умирает столько же здоровых, сколько заражается.

![Модель SIR с учетом демографии при $\beta = 1$, $\nu = 0.3$, $\mu = 0.8$. OpenModelica](image/21.png){#fig:022 width=40%}

## Анализ графиков при разных параметрах модели

![Модель SIR с учетом демографии при $\beta = 1$, $\nu = 0.4$, $\mu = 0.1$. OpenModelica](image/22.png){#fig:023 width=70%} 

## Анализ графиков при разных параметрах модели

![Модель SIR с учетом демографии при $\beta = 1$, $\nu = 0.3$, $\mu = 0.05$. OpenModelica](image/23.png){#fig:024 width=70%}

## Анализ графиков при разных параметрах модели

![Модель SIR с учетом демографии при $\beta = 4$, $\nu = 0.3$, $\mu = 0.1$. OpenModelica](image/24.png){#fig:025 width=70%} 

## Анализ графиков при разных параметрах модели

![Модель SIR с учетом демографии при $\beta = 1$, $\nu = 0.3$, $\mu = 0.4$. OpenModelica](image/25.png){#fig:026 width=70%} 

## Выводы

Мы исслеодвали модель эпидемии(SIR) с помощью программы *xcos* и OpenModelica.
